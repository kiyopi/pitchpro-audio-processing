<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PitchPro Utils Features Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a1a1a;
            color: #e5e5e5;
        }
        
        .section {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #f59e0b;
        }
        
        .test-button {
            background: #f59e0b;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        .test-button:disabled {
            background: #6b7280;
            cursor: not-allowed;
        }
        
        .test-results {
            background: #374151;
            border-radius: 5px;
            padding: 15px;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .input-group {
            margin: 10px 0;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #d1d5db;
        }
        
        .input-group input, .input-group select {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #6b7280;
            background: #374151;
            color: #e5e5e5;
            margin-right: 10px;
        }
        
        .scale-display, .chord-display {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .note-box {
            background: #4b5563;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
        }
        
        .error { color: #ef4444; }
        .success { color: #10b981; }
        .warning { color: #f59e0b; }
        .info { color: #3b82f6; }
        
        .harmonics-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
            margin-top: 10px;
        }
        
        .harmonic-box {
            background: #1f2937;
            padding: 8px;
            border-radius: 4px;
            text-align: center;
            border-left: 3px solid #10b981;
        }
    </style>
</head>
<body>
    <h1>ğŸ”¢ PitchPro Utils Features Test</h1>
    
    <div class="section">
        <h2>ğŸµ FrequencyUtils Test</h2>
        <p>å‘¨æ³¢æ•°å¤‰æ›ã¨ãƒãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯åˆ†æãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
        
        <div class="input-group">
            <label>ãƒ†ã‚¹ãƒˆå‘¨æ³¢æ•° (Hz):</label>
            <input type="number" id="test-frequency" value="440" min="20" max="8000" step="0.1">
            <button class="test-button" onclick="testFrequencyConversions()">å¤‰æ›ãƒ†ã‚¹ãƒˆ</button>
        </div>
        
        <div class="input-group">
            <label>åŸºæœ¬å‘¨æ³¢æ•° (Hz):</label>
            <input type="number" id="fundamental-freq" value="220" min="20" max="2000" step="0.1">
            <button class="test-button" onclick="testHarmonics()">ãƒãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯åˆ†æ</button>
        </div>
        
        <button class="test-button" onclick="testFrequencyRanges()">æ¥½å™¨éŸ³åŸŸãƒ†ã‚¹ãƒˆ</button>
        <button class="test-button" onclick="testScientificPitch()">ç§‘å­¦çš„ãƒ”ãƒƒãƒè¨˜æ³•ãƒ†ã‚¹ãƒˆ</button>
        
        <div id="frequency-results" class="test-results"></div>
        <div id="harmonics-display" class="harmonics-display"></div>
    </div>
    
    <div class="section">
        <h2>ğŸ¼ MusicTheory Test</h2>
        <p>éŸ³æ¥½ç†è«–ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆã‚¹ã‚±ãƒ¼ãƒ«ãƒ»ã‚³ãƒ¼ãƒ‰ãƒ»èª¿æ€§åˆ†æï¼‰ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
        
        <div class="input-group">
            <label>ãƒ«ãƒ¼ãƒˆéŸ³:</label>
            <select id="root-note">
                <option value="C4">C4</option>
                <option value="D4">D4</option>
                <option value="E4">E4</option>
                <option value="F4">F4</option>
                <option value="G4">G4</option>
                <option value="A4" selected>A4</option>
                <option value="B4">B4</option>
            </select>
            
            <label>ã‚¹ã‚±ãƒ¼ãƒ«:</label>
            <select id="scale-type">
                <option value="major" selected>Major</option>
                <option value="naturalMinor">Natural Minor</option>
                <option value="harmonicMinor">Harmonic Minor</option>
                <option value="dorian">Dorian</option>
                <option value="pentatonicMajor">Pentatonic Major</option>
                <option value="pentatonicMinor">Pentatonic Minor</option>
                <option value="blues">Blues</option>
            </select>
            <button class="test-button" onclick="generateScale()">ã‚¹ã‚±ãƒ¼ãƒ«ç”Ÿæˆ</button>
        </div>
        
        <div class="input-group">
            <label>ã‚³ãƒ¼ãƒ‰ãƒ«ãƒ¼ãƒˆ:</label>
            <select id="chord-root">
                <option value="C4" selected>C4</option>
                <option value="D4">D4</option>
                <option value="E4">E4</option>
                <option value="F4">F4</option>
                <option value="G4">G4</option>
                <option value="A4">A4</option>
                <option value="B4">B4</option>
            </select>
            
            <label>ã‚³ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—:</label>
            <select id="chord-type">
                <option value="major" selected>Major</option>
                <option value="minor">Minor</option>
                <option value="diminished">Diminished</option>
                <option value="major7">Major 7</option>
                <option value="minor7">Minor 7</option>
                <option value="dominant7">Dominant 7</option>
            </select>
            <button class="test-button" onclick="generateChord()">ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ</button>
        </div>
        
        <button class="test-button" onclick="testKeySignatures()">èª¿å·ãƒ†ã‚¹ãƒˆ</button>
        <button class="test-button" onclick="testJustIntonation()">ç´”æ­£å¾‹ãƒ†ã‚¹ãƒˆ</button>
        <button class="test-button" onclick="testChordProgression()">ã‚³ãƒ¼ãƒ‰é€²è¡Œãƒ†ã‚¹ãƒˆ</button>
        
        <div id="music-theory-results" class="test-results"></div>
        <div id="scale-display" class="scale-display"></div>
        <div id="chord-display" class="chord-display"></div>
    </div>

    <script src="../dist-umd/pitchpro.umd.js"></script>
    <script>
        let log = (elementId, message, type = 'info') => {
            const element = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : type === 'warning' ? 'warning' : type === 'info' ? 'info' : '';
            element.innerHTML += `<span class="${className}">[${timestamp}] ${message}</span>\n`;
            element.scrollTop = element.scrollHeight;
        };

        // FrequencyUtils Tests
        function testFrequencyConversions() {
            const resultId = 'frequency-results';
            document.getElementById(resultId).innerHTML = '';
            
            try {
                const frequency = parseFloat(document.getElementById('test-frequency').value);
                log(resultId, `ğŸµ ${frequency}Hz ã®å¤‰æ›ãƒ†ã‚¹ãƒˆé–‹å§‹`, 'info');
                
                // MIDIå¤‰æ›
                const midi = PitchPro.FrequencyUtils.frequencyToMidi(frequency);
                log(resultId, `MIDIç•ªå·: ${midi}`, 'info');
                
                const backToFreq = PitchPro.FrequencyUtils.midiToFrequency(midi);
                log(resultId, `MIDIã‹ã‚‰é€†å¤‰æ›: ${backToFreq.toFixed(2)}Hz`, 'info');
                
                // ãƒãƒ¼ãƒˆåå¤‰æ›
                const note = PitchPro.FrequencyUtils.frequencyToNote(frequency);
                log(resultId, `ãƒãƒ¼ãƒˆ: ${note.name} (ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–: ${note.octave})`, 'success');
                
                // ã‚»ãƒ³ãƒˆåå·®
                const cents = PitchPro.FrequencyUtils.frequencyToCents(frequency);
                const formattedCents = PitchPro.FrequencyUtils.formatCents(cents);
                log(resultId, `ã‚»ãƒ³ãƒˆåå·®: ${formattedCents}`, 'info');
                
                // æœ€ã‚‚è¿‘ã„ãƒãƒ¼ãƒˆå‘¨æ³¢æ•°
                const closestNote = PitchPro.FrequencyUtils.getClosestNoteFrequency(frequency);
                log(resultId, `æœ€å¯„ã‚Šãƒãƒ¼ãƒˆå‘¨æ³¢æ•°: ${closestNote.toFixed(2)}Hz`, 'info');
                
                // æ¥½å™¨éŸ³åŸŸãƒã‚§ãƒƒã‚¯
                const inVocal = PitchPro.FrequencyUtils.isInVocalRange(frequency);
                const inPiano = PitchPro.FrequencyUtils.isInPianoRange(frequency);
                log(resultId, `éŸ³åŸŸãƒã‚§ãƒƒã‚¯ - å£°æ¥½: ${inVocal ? 'Yes' : 'No'}, ãƒ”ã‚¢ãƒ: ${inPiano ? 'Yes' : 'No'}`, inVocal ? 'success' : 'warning');
                
                // å‘¨æ³¢æ•°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
                const formatted = PitchPro.FrequencyUtils.formatFrequency(frequency);
                log(resultId, `ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¸ˆã¿è¡¨ç¤º: ${formatted}`, 'info');
                
                log(resultId, 'âœ… å¤‰æ›ãƒ†ã‚¹ãƒˆå®Œäº†', 'success');
                
            } catch (error) {
                log(resultId, `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                console.error('FrequencyUtils conversion test error:', error);
            }
        }
        
        function testHarmonics() {
            const resultId = 'frequency-results';
            const harmonicsDisplay = document.getElementById('harmonics-display');
            
            try {
                const fundamental = parseFloat(document.getElementById('fundamental-freq').value);
                log(resultId, `ğŸ”Š ${fundamental}Hz ã®ãƒãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯åˆ†æé–‹å§‹`, 'info');
                
                // ãƒãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ç”Ÿæˆ
                const harmonics = PitchPro.FrequencyUtils.findHarmonics(fundamental, 8);
                log(resultId, `ãƒãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ç”Ÿæˆ: ${harmonics.length}å€‹`, 'info');
                
                // ãƒãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯è¡¨ç¤º
                harmonicsDisplay.innerHTML = harmonics.map((harmonic, index) => {
                    const note = PitchPro.FrequencyUtils.frequencyToNote(harmonic);
                    return `<div class="harmonic-box">
                        <div>${index + 1}æ¬¡</div>
                        <div>${harmonic.toFixed(1)}Hz</div>
                        <div>${note.name}</div>
                    </div>`;
                }).join('');
                
                // é€†ãƒãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯åˆ†æ
                const testFreq = harmonics[2]; // 3æ¬¡ãƒãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯
                const harmonicCheck = PitchPro.FrequencyUtils.isHarmonic(testFreq, fundamental);
                log(resultId, `${testFreq.toFixed(1)}Hzã®ãƒãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯åˆ¤å®š:`, 'info');
                log(resultId, `  åˆ¤å®š: ${harmonicCheck.isHarmonic ? 'Yes' : 'No'}`, harmonicCheck.isHarmonic ? 'success' : 'warning');
                if (harmonicCheck.isHarmonic) {
                    log(resultId, `  ãƒãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ç•ªå·: ${harmonicCheck.harmonicNumber}`, 'info');
                    log(resultId, `  ç†è«–å€¤: ${harmonicCheck.exactFrequency?.toFixed(1)}Hz`, 'info');
                }
                
                // åŸºéŸ³è¨ˆç®—ãƒ†ã‚¹ãƒˆ
                const calculatedFundamental = PitchPro.FrequencyUtils.calculateFundamental(harmonics[3], 4);
                log(resultId, `4æ¬¡ãƒãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ã‹ã‚‰åŸºéŸ³è¨ˆç®—: ${calculatedFundamental.toFixed(1)}Hz`, 'info');
                
                log(resultId, 'âœ… ãƒãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯åˆ†æå®Œäº†', 'success');
                
            } catch (error) {
                log(resultId, `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }
        
        function testFrequencyRanges() {
            const resultId = 'frequency-results';
            
            try {
                log(resultId, 'ğŸ¸ æ¥½å™¨éŸ³åŸŸãƒ†ã‚¹ãƒˆé–‹å§‹', 'info');
                
                const instruments = ['piano', 'guitar', 'violin', 'cello', 'voice_bass', 'voice_tenor', 'voice_alto', 'voice_soprano'];
                
                instruments.forEach(instrument => {
                    const range = PitchPro.FrequencyUtils.getInstrumentRange(instrument);
                    if (range) {
                        const minNote = PitchPro.FrequencyUtils.frequencyToNote(range.min);
                        const maxNote = PitchPro.FrequencyUtils.frequencyToNote(range.max);
                        log(resultId, `${instrument}: ${range.min.toFixed(1)}Hz (${minNote.name}) - ${range.max.toFixed(1)}Hz (${maxNote.name})`, 'info');
                    }
                });
                
                log(resultId, 'âœ… æ¥½å™¨éŸ³åŸŸãƒ†ã‚¹ãƒˆå®Œäº†', 'success');
                
            } catch (error) {
                log(resultId, `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }
        
        function testScientificPitch() {
            const resultId = 'frequency-results';
            
            try {
                log(resultId, 'ğŸ”¬ ç§‘å­¦çš„ãƒ”ãƒƒãƒè¨˜æ³•ãƒ†ã‚¹ãƒˆé–‹å§‹', 'info');
                
                const testNotes = ['A4', 'C4', 'F#5', 'Bb3', 'G#2'];
                
                testNotes.forEach(note => {
                    const frequency = PitchPro.FrequencyUtils.scientificPitchToFrequency(note);
                    const backToNote = PitchPro.FrequencyUtils.frequencyToScientificPitch(frequency);
                    log(resultId, `${note} â†’ ${frequency.toFixed(2)}Hz â†’ ${backToNote}`, frequency > 0 ? 'success' : 'error');
                });
                
                log(resultId, 'âœ… ç§‘å­¦çš„ãƒ”ãƒƒãƒè¨˜æ³•ãƒ†ã‚¹ãƒˆå®Œäº†', 'success');
                
            } catch (error) {
                log(resultId, `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        // MusicTheory Tests
        function generateScale() {
            const resultId = 'music-theory-results';
            const scaleDisplay = document.getElementById('scale-display');
            
            try {
                const rootNote = document.getElementById('root-note').value;
                const scaleType = document.getElementById('scale-type').value;
                
                log(resultId, `ğŸ¼ ${rootNote} ${scaleType}ã‚¹ã‚±ãƒ¼ãƒ«ç”Ÿæˆé–‹å§‹`, 'info');
                
                const rootFreq = PitchPro.FrequencyUtils.scientificPitchToFrequency(rootNote);
                const scale = PitchPro.MusicTheory.generateScale(rootFreq, scaleType);
                
                log(resultId, `ã‚¹ã‚±ãƒ¼ãƒ«ç”Ÿæˆå®Œäº†: ${scale.length}éŸ³`, 'success');
                
                // ã‚¹ã‚±ãƒ¼ãƒ«è¡¨ç¤º
                scaleDisplay.innerHTML = scale.map((note, index) => {
                    return `<div class="note-box">
                        <div>${index + 1}</div>
                        <div><strong>${note.name}</strong></div>
                        <div>${note.frequency.toFixed(1)}Hz</div>
                    </div>`;
                }).join('');
                
                // ã‚¹ã‚±ãƒ¼ãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³è¡¨ç¤º
                const pattern = PitchPro.MusicTheory.SCALE_PATTERNS[scaleType];
                log(resultId, `ãƒ‘ã‚¿ãƒ¼ãƒ³: ${pattern.join('-')}`, 'info');
                
                log(resultId, 'âœ… ã‚¹ã‚±ãƒ¼ãƒ«ç”Ÿæˆå®Œäº†', 'success');
                
            } catch (error) {
                log(resultId, `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }
        
        function generateChord() {
            const resultId = 'music-theory-results';
            const chordDisplay = document.getElementById('chord-display');
            
            try {
                const chordRoot = document.getElementById('chord-root').value;
                const chordType = document.getElementById('chord-type').value;
                
                log(resultId, `ğŸ¹ ${chordRoot} ${chordType}ã‚³ãƒ¼ãƒ‰ç”Ÿæˆé–‹å§‹`, 'info');
                
                const rootFreq = PitchPro.FrequencyUtils.scientificPitchToFrequency(chordRoot);
                const chord = PitchPro.MusicTheory.generateChord(rootFreq, chordType);
                
                log(resultId, `ã‚³ãƒ¼ãƒ‰ç”Ÿæˆå®Œäº†: ${chord.length}éŸ³`, 'success');
                
                // ã‚³ãƒ¼ãƒ‰è¡¨ç¤º
                chordDisplay.innerHTML = chord.map((note, index) => {
                    const chordTones = ['Root', '3rd', '5th', '7th', '9th'];
                    return `<div class="note-box">
                        <div>${chordTones[index] || (index + 1)}</div>
                        <div><strong>${note.name}</strong></div>
                        <div>${note.frequency.toFixed(1)}Hz</div>
                    </div>`;
                }).join('');
                
                // ã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³è¡¨ç¤º
                const pattern = PitchPro.MusicTheory.CHORD_PATTERNS[chordType];
                log(resultId, `ãƒ‘ã‚¿ãƒ¼ãƒ³: ${pattern.join('-')}`, 'info');
                
                log(resultId, 'âœ… ã‚³ãƒ¼ãƒ‰ç”Ÿæˆå®Œäº†', 'success');
                
            } catch (error) {
                log(resultId, `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }
        
        function testKeySignatures() {
            const resultId = 'music-theory-results';
            
            try {
                log(resultId, 'ğŸµ èª¿å·ãƒ†ã‚¹ãƒˆé–‹å§‹', 'info');
                
                const majorKeys = ['C', 'G', 'D', 'A', 'E', 'B', 'F#', 'F', 'Bb', 'Eb', 'Ab'];
                const minorKeys = ['A', 'E', 'B', 'F#', 'C#', 'G#', 'D', 'G', 'C', 'F'];
                
                log(resultId, 'ãƒ¡ã‚¸ãƒ£ãƒ¼ã‚­ãƒ¼:', 'info');
                majorKeys.forEach(key => {
                    const signature = PitchPro.MusicTheory.getKeySignature(key, 'major');
                    const accidentals = signature.sharps.length > 0 ? 
                        `â™¯${signature.sharps.length}å€‹: ${signature.sharps.join(', ')}` :
                        signature.flats.length > 0 ? 
                        `â™­${signature.flats.length}å€‹: ${signature.flats.join(', ')}` : 
                        'èª¿å·ãªã—';
                    log(resultId, `  ${key}ãƒ¡ã‚¸ãƒ£ãƒ¼: ${accidentals}`, 'info');
                });
                
                log(resultId, 'ãƒã‚¤ãƒŠãƒ¼ã‚­ãƒ¼:', 'info');
                minorKeys.forEach(key => {
                    const signature = PitchPro.MusicTheory.getKeySignature(key, 'minor');
                    const accidentals = signature.sharps.length > 0 ? 
                        `â™¯${signature.sharps.length}å€‹: ${signature.sharps.join(', ')}` :
                        signature.flats.length > 0 ? 
                        `â™­${signature.flats.length}å€‹: ${signature.flats.join(', ')}` : 
                        'èª¿å·ãªã—';
                    log(resultId, `  ${key}ãƒã‚¤ãƒŠãƒ¼: ${accidentals}`, 'info');
                });
                
                log(resultId, 'âœ… èª¿å·ãƒ†ã‚¹ãƒˆå®Œäº†', 'success');
                
            } catch (error) {
                log(resultId, `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }
        
        function testJustIntonation() {
            const resultId = 'music-theory-results';
            
            try {
                log(resultId, 'ğŸ¶ ç´”æ­£å¾‹ãƒ†ã‚¹ãƒˆé–‹å§‹', 'info');
                
                const justRatios = PitchPro.MusicTheory.getJustIntonationRatios();
                
                log(resultId, 'ç´”æ­£å¾‹éŸ³ç¨‹:', 'info');
                Object.entries(justRatios).forEach(([interval, { ratio, cents }]) => {
                    const equalTempCents = Object.keys(PitchPro.FrequencyUtils.INTERVALS)
                        .find(key => key.includes(interval.replace(/([A-Z])/g, '$1').toLowerCase()));
                    
                    const etCents = equalTempCents ? PitchPro.FrequencyUtils.INTERVALS[equalTempCents] * 100 : 0;
                    const deviation = etCents ? Math.round(cents - etCents) : 0;
                    
                    log(resultId, `  ${interval}: ${ratio.toFixed(4)} (${cents}Â¢, å¹³å‡å¾‹ã‹ã‚‰ã®å·®: ${deviation > 0 ? '+' : ''}${deviation}Â¢)`, 'info');
                });
                
                // å¹³å‡å¾‹ã‹ã‚‰ç´”æ­£å¾‹ã¸ã®å¤‰æ›ãƒ†ã‚¹ãƒˆ
                log(resultId, 'å¹³å‡å¾‹â†’ç´”æ­£å¾‹å¤‰æ›ãƒ†ã‚¹ãƒˆ:', 'info');
                [5, 7, 12].forEach(semitones => {
                    const conversion = PitchPro.MusicTheory.equalTemperamentToJustIntonation(semitones);
                    log(resultId, `  ${semitones}åŠéŸ³: ${conversion.closestJustInterval} (åå·®: ${conversion.centsDeviation?.toFixed(1)}Â¢)`, 'info');
                });
                
                log(resultId, 'âœ… ç´”æ­£å¾‹ãƒ†ã‚¹ãƒˆå®Œäº†', 'success');
                
            } catch (error) {
                log(resultId, `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }
        
        function testChordProgression() {
            const resultId = 'music-theory-results';
            
            try {
                log(resultId, 'ğŸ¼ ã‚³ãƒ¼ãƒ‰é€²è¡Œãƒ†ã‚¹ãƒˆé–‹å§‹', 'info');
                
                // ä¸€èˆ¬çš„ãªã‚³ãƒ¼ãƒ‰é€²è¡Œã‚’ãƒ†ã‚¹ãƒˆ
                const progressions = [
                    { name: 'I-IV-V-I (ç‹é“)', pattern: [1, 4, 5, 1] },
                    { name: 'vi-IV-I-V (4536)', pattern: [6, 4, 1, 5] },
                    { name: 'I-vi-IV-V (å¾ªç’°)', pattern: [1, 6, 4, 5] }
                ];
                
                progressions.forEach(({ name, pattern }) => {
                    log(resultId, `${name}:`, 'info');
                    
                    // Cãƒ¡ã‚¸ãƒ£ãƒ¼ã§ç”Ÿæˆ
                    const chords = PitchPro.MusicTheory.generateChordProgression('C', 'major', pattern);
                    
                    const chordNames = chords.map((chord, index) => {
                        const roman = ['I', 'ii', 'iii', 'IV', 'V', 'vi', 'viiÂ°'][pattern[index] - 1];
                        const root = chord[0].name.replace(/\d+$/, ''); // ã‚ªã‚¯ã‚¿ãƒ¼ãƒ–ç•ªå·ã‚’é™¤å»
                        return `${roman}(${root})`;
                    });
                    
                    log(resultId, `  ${chordNames.join(' - ')}`, 'success');
                });
                
                // ãƒãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ã‚·ãƒªãƒ¼ã‚ºãƒ†ã‚¹ãƒˆ
                log(resultId, 'ãƒãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ã‚·ãƒªãƒ¼ã‚º (C2åŸºæº–):', 'info');
                const fundamental = PitchPro.FrequencyUtils.scientificPitchToFrequency('C2');
                const harmonicSeries = PitchPro.MusicTheory.getHarmonicSeries(fundamental, 8);
                
                const harmonicNames = harmonicSeries.map((note, index) => {
                    const harmonic = index + 1;
                    return `${harmonic}: ${note.name.replace(/\d+$/, '')}`;
                });
                
                log(resultId, `  ${harmonicNames.join(', ')}`, 'info');
                
                log(resultId, 'âœ… ã‚³ãƒ¼ãƒ‰é€²è¡Œãƒ†ã‚¹ãƒˆå®Œäº†', 'success');
                
            } catch (error) {
                log(resultId, `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            console.log('PitchPro Utils Features Test loaded');
            
            // ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒæ­£å¸¸ã«èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
            if (typeof PitchPro === 'undefined') {
                document.body.innerHTML = '<h1 style="color: red;">âŒ PitchProãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“</h1>';
                return;
            }
            
            // åˆ©ç”¨å¯èƒ½ãªUtilsæ©Ÿèƒ½ã‚’ç¢ºèª
            const availableFeatures = {
                FrequencyUtils: !!PitchPro.FrequencyUtils,
                MusicTheory: !!PitchPro.MusicTheory
            };
            
            console.log('åˆ©ç”¨å¯èƒ½ãªUtilsæ©Ÿèƒ½:', availableFeatures);
            
            // ã‚µãƒ³ãƒ—ãƒ«æ©Ÿèƒ½ã®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            const demoFrequency = 440;
            const demoNote = PitchPro.FrequencyUtils.frequencyToNote(demoFrequency);
            console.log(`ãƒ‡ãƒ¢: ${demoFrequency}Hz = ${demoNote.name}`);
        });
    </script>
</body>
</html>