<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>README.md æ›´æ–°å†…å®¹æ¤œè¨¼ãƒ†ã‚¹ãƒˆ - PitchPro v1.3.1</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .test-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .test-section h3 {
            color: #64b5f6;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ffc107;
            display: inline-block;
        }

        .status-indicator.success { background: #4caf50; }
        .status-indicator.error { background: #f44336; }

        .method-test {
            margin: 15px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border-left: 4px solid #64b5f6;
        }

        .method-name {
            font-weight: bold;
            color: #81c784;
            margin-bottom: 5px;
        }

        .method-result {
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #e0e0e0;
            margin-top: 8px;
        }

        .btn {
            background: linear-gradient(45deg, #42a5f5, #478ed1);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(66, 165, 245, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(66, 165, 245, 0.4);
        }

        .btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn.danger {
            background: linear-gradient(45deg, #ef5350, #e53935);
            box-shadow: 0 4px 15px rgba(239, 83, 80, 0.3);
        }

        .btn.success {
            background: linear-gradient(45deg, #66bb6a, #4caf50);
            box-shadow: 0 4px 15px rgba(102, 187, 106, 0.3);
        }

        .log-output {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            margin-top: 15px;
        }

        .log-entry {
            margin: 5px 0;
            padding: 2px 0;
        }

        .log-entry.success { color: #4caf50; }
        .log-entry.error { color: #f44336; }
        .log-entry.info { color: #2196f3; }
        .log-entry.warn { color: #ff9800; }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .audio-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .volume-bar {
            background: rgba(255, 255, 255, 0.1);
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .volume-fill {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #8bc34a);
            transition: width 0.1s ease;
            width: 0%;
        }

        .frequency-display {
            font-size: 1.2em;
            font-weight: bold;
            color: #64b5f6;
            text-align: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§ª README.md æ›´æ–°å†…å®¹æ¤œè¨¼ãƒ†ã‚¹ãƒˆ</h1>
            <p>PitchPro v1.3.1 - æ–°è¦è¿½åŠ ãƒ¡ã‚½ãƒƒãƒ‰ã¨æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª</p>
            <div>
                <span class="status-indicator" id="overall-status"></span>
                <span id="overall-status-text">åˆæœŸåŒ–å¾…æ©Ÿä¸­...</span>
            </div>
        </div>

        <!-- MicrophoneController ãƒ¡ã‚½ãƒƒãƒ‰æ¤œè¨¼ -->
        <div class="test-section">
            <h3>
                <span class="status-indicator" id="mic-controller-status"></span>
                ğŸ¤ MicrophoneController æ–°è¦è¿½åŠ ãƒ¡ã‚½ãƒƒãƒ‰æ¤œè¨¼
            </h3>
            <p>README.mdã«æ–°è¦è¿½åŠ ã—ãŸMicrophoneControllerãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§ã®å‹•ä½œç¢ºèª</p>

            <div class="controls">
                <button class="btn" id="test-mic-controller">MicrophoneControllerä½œæˆ</button>
                <button class="btn" id="test-mic-initialize" disabled>initialize()ãƒ†ã‚¹ãƒˆ</button>
                <button class="btn" id="test-mic-sensitivity" disabled>setSensitivity()ãƒ†ã‚¹ãƒˆ</button>
                <button class="btn" id="test-mic-status" disabled>getStatus()ãƒ†ã‚¹ãƒˆ</button>
                <button class="btn danger" id="test-mic-reset" disabled>reset()ãƒ†ã‚¹ãƒˆï¼ˆFAQæ¨å¥¨ï¼‰</button>
            </div>

            <div id="mic-controller-results"></div>
        </div>

        <!-- AudioDetectionComponent æ–°è¦ãƒ¡ã‚½ãƒƒãƒ‰æ¤œè¨¼ -->
        <div class="test-section">
            <h3>
                <span class="status-indicator" id="audio-detection-status"></span>
                ğŸ“‹ AudioDetectionComponent æ–°è¦è¿½åŠ ãƒ¡ã‚½ãƒƒãƒ‰æ¤œè¨¼
            </h3>
            <p>æ–°è¦è¿½åŠ ã•ã‚ŒãŸ3ã¤ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å‹•ä½œç¢ºèª</p>

            <div class="controls">
                <button class="btn" id="test-audio-component">AudioDetectionComponentä½œæˆ</button>
                <button class="btn" id="test-reset-display" disabled>resetDisplayElements()ãƒ†ã‚¹ãƒˆ</button>
                <button class="btn" id="test-mic-controller-getter" disabled>microphoneControllerã‚²ãƒƒã‚¿ãƒ¼</button>
                <button class="btn" id="test-device-optimize" disabled>detectAndOptimizeDevice()ãƒ†ã‚¹ãƒˆ</button>
            </div>

            <!-- éŸ³é‡ãƒãƒ¼ãƒ»å‘¨æ³¢æ•°è¡¨ç¤ºï¼ˆãƒªã‚»ãƒƒãƒˆãƒ†ã‚¹ãƒˆç”¨ï¼‰ -->
            <div class="audio-controls">
                <div>
                    <label>éŸ³é‡ãƒ¬ãƒ™ãƒ«</label>
                    <div class="volume-bar">
                        <div class="volume-fill" id="volume-bar-test"></div>
                    </div>
                    <div>éŸ³é‡: <span id="volume-text-test">0%</span></div>
                </div>
                <div>
                    <label>æ¤œå‡ºå‘¨æ³¢æ•°</label>
                    <div class="frequency-display" id="frequency-display-test">440.0 Hz (A4)</div>
                </div>
            </div>

            <div id="audio-detection-results"></div>
        </div>

        <!-- FAQæ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œè¨¼ -->
        <div class="test-section">
            <h3>
                <span class="status-indicator" id="faq-pattern-status"></span>
                ğŸ“– FAQæ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œè¨¼
            </h3>
            <p>FAQæ›´æ–°ã§èª¬æ˜ã—ãŸ3ã¤ã®ãƒªã‚»ãƒƒãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã®å‹•ä½œç¢ºèª</p>

            <div class="controls">
                <button class="btn" id="simulate-usage">éŸ³é‡ãƒ»å‘¨æ³¢æ•°ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ</button>
                <button class="btn" id="test-faq-pattern1" disabled>æ–¹æ³•1: stopDetection + resetDisplayElements</button>
                <button class="btn" id="test-faq-pattern2" disabled>æ–¹æ³•2: MicrophoneController.reset()</button>
                <button class="btn" id="test-faq-pattern3" disabled>æ–¹æ³•3: è©³ç´°åˆ¶å¾¡ãƒ‘ã‚¿ãƒ¼ãƒ³</button>
            </div>

            <div id="faq-pattern-results"></div>
        </div>

        <!-- çµ±åˆãƒ†ã‚¹ãƒˆ -->
        <div class="test-section">
            <h3>
                <span class="status-indicator" id="integration-status"></span>
                ğŸ”— çµ±åˆãƒ†ã‚¹ãƒˆ
            </h3>
            <p>v1.3.1çµ±åˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å…¨ä½“å‹•ä½œç¢ºèª</p>

            <div class="controls">
                <button class="btn success" id="run-full-integration">å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
                <button class="btn danger" id="reset-all-tests">å…¨ãƒ†ã‚¹ãƒˆãƒªã‚»ãƒƒãƒˆ</button>
            </div>

            <div id="integration-results"></div>
        </div>

        <!-- ãƒ­ã‚°å‡ºåŠ› -->
        <div class="test-section">
            <h3>ğŸ“‹ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒ­ã‚°</h3>
            <div class="log-output" id="test-log"></div>
        </div>
    </div>

    <!-- PitchPro v1.3.1 ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿ -->
    <script src="dist/pitchpro.umd.js"></script>

    <script>
        // ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ 
        class TestLogger {
            constructor() {
                this.logContainer = document.getElementById('test-log');
            }

            log(message, type = 'info') {
                const timestamp = new Date().toLocaleTimeString();
                const entry = document.createElement('div');
                entry.className = `log-entry ${type}`;
                entry.textContent = `[${timestamp}] ${message}`;
                this.logContainer.appendChild(entry);
                this.logContainer.scrollTop = this.logContainer.scrollHeight;

                // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚‚å‡ºåŠ›
                console.log(`[TestLogger:${type}] ${message}`);
            }

            success(message) { this.log(message, 'success'); }
            error(message) { this.log(message, 'error'); }
            warn(message) { this.log(message, 'warn'); }
            info(message) { this.log(message, 'info'); }
        }

        // ãƒ†ã‚¹ãƒˆçŠ¶æ…‹ç®¡ç†
        class TestManager {
            constructor() {
                this.logger = new TestLogger();
                this.micController = null;
                this.audioDetector = null;
                this.testResults = {
                    micController: false,
                    audioDetection: false,
                    faqPattern: false,
                    integration: false
                };

                this.setupEventListeners();
                this.checkPitchProAvailability();
            }

            checkPitchProAvailability() {
                if (typeof window.PitchPro === 'undefined') {
                    this.logger.error('âŒ PitchPro ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
                    this.updateOverallStatus('error', 'PitchProæœªèª­ã¿è¾¼ã¿');
                    return false;
                }

                // å¿…è¦ãªã‚¯ãƒ©ã‚¹ã®å­˜åœ¨ç¢ºèª
                const required = ['MicrophoneController', 'AudioDetectionComponent'];
                const missing = required.filter(cls => !window.PitchPro[cls]);

                if (missing.length > 0) {
                    this.logger.error(`âŒ å¿…é ˆã‚¯ãƒ©ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${missing.join(', ')}`);
                    this.updateOverallStatus('error', `ã‚¯ãƒ©ã‚¹æœªå®šç¾©: ${missing.join(', ')}`);
                    return false;
                }

                this.logger.success('âœ… PitchPro v1.3.1 ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿å®Œäº†');
                this.updateOverallStatus('success', 'ãƒ©ã‚¤ãƒ–ãƒ©ãƒªæº–å‚™å®Œäº†');
                return true;
            }

            updateStatus(sectionId, status) {
                const indicator = document.getElementById(`${sectionId}-status`);
                if (indicator) {
                    indicator.className = `status-indicator ${status}`;
                }
            }

            updateOverallStatus(status, text) {
                const indicator = document.getElementById('overall-status');
                const textElement = document.getElementById('overall-status-text');

                if (indicator) indicator.className = `status-indicator ${status}`;
                if (textElement) textElement.textContent = text;
            }

            addResult(containerId, methodName, result, details) {
                const container = document.getElementById(containerId);
                const resultDiv = document.createElement('div');
                resultDiv.className = 'method-test';

                resultDiv.innerHTML = `
                    <div class="method-name">${methodName}</div>
                    <div class="method-result">
                        <strong>çµæœ:</strong> ${result ? 'âœ… æˆåŠŸ' : 'âŒ å¤±æ•—'}<br>
                        <strong>è©³ç´°:</strong> ${details}
                    </div>
                `;

                container.appendChild(resultDiv);
            }

            setupEventListeners() {
                // MicrophoneController ãƒ†ã‚¹ãƒˆ
                document.getElementById('test-mic-controller').addEventListener('click', () => this.testMicrophoneController());
                document.getElementById('test-mic-initialize').addEventListener('click', () => this.testMicInitialize());
                document.getElementById('test-mic-sensitivity').addEventListener('click', () => this.testMicSensitivity());
                document.getElementById('test-mic-status').addEventListener('click', () => this.testMicStatus());
                document.getElementById('test-mic-reset').addEventListener('click', () => this.testMicReset());

                // AudioDetectionComponent ãƒ†ã‚¹ãƒˆ
                document.getElementById('test-audio-component').addEventListener('click', () => this.testAudioComponent());
                document.getElementById('test-reset-display').addEventListener('click', () => this.testResetDisplay());
                document.getElementById('test-mic-controller-getter').addEventListener('click', () => this.testMicControllerGetter());
                document.getElementById('test-device-optimize').addEventListener('click', () => this.testDeviceOptimize());

                // FAQ ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ†ã‚¹ãƒˆ
                document.getElementById('simulate-usage').addEventListener('click', () => this.simulateUsage());
                document.getElementById('test-faq-pattern1').addEventListener('click', () => this.testFAQPattern1());
                document.getElementById('test-faq-pattern2').addEventListener('click', () => this.testFAQPattern2());
                document.getElementById('test-faq-pattern3').addEventListener('click', () => this.testFAQPattern3());

                // çµ±åˆãƒ†ã‚¹ãƒˆ
                document.getElementById('run-full-integration').addEventListener('click', () => this.runFullIntegration());
                document.getElementById('reset-all-tests').addEventListener('click', () => this.resetAllTests());
            }

            // MicrophoneController ãƒ†ã‚¹ãƒˆç¾¤
            async testMicrophoneController() {
                try {
                    this.logger.info('ğŸ¤ MicrophoneController ä½œæˆãƒ†ã‚¹ãƒˆé–‹å§‹');

                    this.micController = new window.PitchPro.MicrophoneController();

                    if (this.micController) {
                        this.logger.success('âœ… MicrophoneController ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆæˆåŠŸ');
                        this.addResult('mic-controller-results', 'new MicrophoneController()', true, 'ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆå®Œäº†');

                        // æ¬¡ã®ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
                        document.getElementById('test-mic-initialize').disabled = false;
                        document.getElementById('test-mic-sensitivity').disabled = false;
                        document.getElementById('test-mic-status').disabled = false;
                        document.getElementById('test-mic-reset').disabled = false;

                        this.updateStatus('mic-controller', 'success');
                        return true;
                    }
                } catch (error) {
                    this.logger.error(`âŒ MicrophoneController ä½œæˆå¤±æ•—: ${error.message}`);
                    this.addResult('mic-controller-results', 'new MicrophoneController()', false, error.message);
                    this.updateStatus('mic-controller', 'error');
                }
                return false;
            }

            async testMicInitialize() {
                if (!this.micController) {
                    this.logger.warn('âš ï¸ MicrophoneController ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“');
                    return false;
                }

                try {
                    this.logger.info('ğŸ”§ initialize() ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆé–‹å§‹');

                    // initialize ãƒ¡ã‚½ãƒƒãƒ‰ã®å­˜åœ¨ç¢ºèª
                    if (typeof this.micController.initialize !== 'function') {
                        throw new Error('initialize ãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨ã—ã¾ã›ã‚“');
                    }

                    this.logger.success('âœ… initialize() ãƒ¡ã‚½ãƒƒãƒ‰å­˜åœ¨ç¢ºèªå®Œäº†');
                    this.addResult('mic-controller-results', 'micController.initialize()', true, 'ãƒ¡ã‚½ãƒƒãƒ‰å­˜åœ¨ç¢ºèª - å®Ÿéš›ã®åˆæœŸåŒ–ã¯ãƒã‚¤ã‚¯è¨±å¯ãŒå¿…è¦ãªãŸã‚ã‚¹ã‚­ãƒƒãƒ—');

                    return true;
                } catch (error) {
                    this.logger.error(`âŒ initialize() ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`);
                    this.addResult('mic-controller-results', 'micController.initialize()', false, error.message);
                }
                return false;
            }

            async testMicSensitivity() {
                if (!this.micController) {
                    this.logger.warn('âš ï¸ MicrophoneController ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“');
                    return false;
                }

                try {
                    this.logger.info('ğŸšï¸ setSensitivity() / getSensitivity() ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆé–‹å§‹');

                    // ãƒ¡ã‚½ãƒƒãƒ‰ã®å­˜åœ¨ç¢ºèª
                    if (typeof this.micController.setSensitivity !== 'function') {
                        throw new Error('setSensitivity ãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨ã—ã¾ã›ã‚“');
                    }
                    if (typeof this.micController.getSensitivity !== 'function') {
                        throw new Error('getSensitivity ãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨ã—ã¾ã›ã‚“');
                    }

                    // æ„Ÿåº¦è¨­å®šãƒ†ã‚¹ãƒˆï¼ˆå®Ÿéš›ã®å€¤è¨­å®šï¼‰
                    this.micController.setSensitivity(3.5);
                    const sensitivity = this.micController.getSensitivity();

                    this.logger.success(`âœ… æ„Ÿåº¦è¨­å®šãƒ†ã‚¹ãƒˆå®Œäº†: ${sensitivity}`);
                    this.addResult('mic-controller-results', 'setSensitivity() / getSensitivity()', true, `æ„Ÿåº¦è¨­å®š: 3.5 â†’ å–å¾—å€¤: ${sensitivity}`);

                    return true;
                } catch (error) {
                    this.logger.error(`âŒ æ„Ÿåº¦è¨­å®šãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`);
                    this.addResult('mic-controller-results', 'setSensitivity() / getSensitivity()', false, error.message);
                }
                return false;
            }

            async testMicStatus() {
                if (!this.micController) {
                    this.logger.warn('âš ï¸ MicrophoneController ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“');
                    return false;
                }

                try {
                    this.logger.info('ğŸ“Š getStatus() ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆé–‹å§‹');

                    if (typeof this.micController.getStatus !== 'function') {
                        throw new Error('getStatus ãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨ã—ã¾ã›ã‚“');
                    }

                    const status = this.micController.getStatus();

                    this.logger.success('âœ… getStatus() ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè¡ŒæˆåŠŸ');
                    this.addResult('mic-controller-results', 'micController.getStatus()', true, `ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ±å–å¾—å®Œäº†: ${JSON.stringify(status, null, 2)}`);

                    return true;
                } catch (error) {
                    this.logger.error(`âŒ getStatus() ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`);
                    this.addResult('mic-controller-results', 'micController.getStatus()', false, error.message);
                }
                return false;
            }

            async testMicReset() {
                if (!this.micController) {
                    this.logger.warn('âš ï¸ MicrophoneController ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“');
                    return false;
                }

                try {
                    this.logger.info('ğŸ”„ reset() ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆé–‹å§‹ï¼ˆFAQæ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰');

                    if (typeof this.micController.reset !== 'function') {
                        throw new Error('reset ãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨ã—ã¾ã›ã‚“');
                    }

                    const result = await this.micController.reset();

                    this.logger.success('âœ… reset() ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè¡ŒæˆåŠŸï¼ˆFAQæ¨å¥¨ï¼‰');
                    this.addResult('mic-controller-results', 'micController.reset() â˜…FAQæ¨å¥¨', true, 'FAQæ¨å¥¨ã®å®Œå…¨ãƒªã‚»ãƒƒãƒˆãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè¡Œå®Œäº†');

                    this.testResults.micController = true;
                    return true;
                } catch (error) {
                    this.logger.error(`âŒ reset() ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`);
                    this.addResult('mic-controller-results', 'micController.reset() â˜…FAQæ¨å¥¨', false, error.message);
                }
                return false;
            }

            // AudioDetectionComponent ãƒ†ã‚¹ãƒˆç¾¤
            async testAudioComponent() {
                try {
                    this.logger.info('ğŸ“‹ AudioDetectionComponent ä½œæˆãƒ†ã‚¹ãƒˆé–‹å§‹');

                    this.audioDetector = new window.PitchPro.AudioDetectionComponent({
                        volumeBarSelector: '#volume-bar-test .volume-fill',
                        volumeTextSelector: '#volume-text-test',
                        frequencySelector: '#frequency-display-test',
                        autoUpdateUI: false, // ãƒ†ã‚¹ãƒˆç”¨ã«æ‰‹å‹•åˆ¶å¾¡
                        debug: true
                    });

                    if (this.audioDetector) {
                        this.logger.success('âœ… AudioDetectionComponent ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆæˆåŠŸ');
                        this.addResult('audio-detection-results', 'new AudioDetectionComponent()', true, 'ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆå®Œäº†');

                        // æ¬¡ã®ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
                        document.getElementById('test-reset-display').disabled = false;
                        document.getElementById('test-mic-controller-getter').disabled = false;
                        document.getElementById('test-device-optimize').disabled = false;

                        this.updateStatus('audio-detection', 'success');
                        return true;
                    }
                } catch (error) {
                    this.logger.error(`âŒ AudioDetectionComponent ä½œæˆå¤±æ•—: ${error.message}`);
                    this.addResult('audio-detection-results', 'new AudioDetectionComponent()', false, error.message);
                    this.updateStatus('audio-detection', 'error');
                }
                return false;
            }

            async testResetDisplay() {
                if (!this.audioDetector) {
                    this.logger.warn('âš ï¸ AudioDetectionComponent ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“');
                    return false;
                }

                try {
                    this.logger.info('ğŸ”„ resetDisplayElements() ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆé–‹å§‹');

                    if (typeof this.audioDetector.resetDisplayElements !== 'function') {
                        throw new Error('resetDisplayElements ãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨ã—ã¾ã›ã‚“');
                    }

                    // ãƒ†ã‚¹ãƒˆå‰ã®çŠ¶æ…‹è¨­å®š
                    document.getElementById('volume-bar-test').style.width = '75%';
                    document.getElementById('volume-text-test').textContent = '75%';
                    document.getElementById('frequency-display-test').textContent = '880.0 Hz (A5)';

                    this.logger.info('ğŸ“Š ãƒªã‚»ãƒƒãƒˆå‰: éŸ³é‡75%, å‘¨æ³¢æ•°880Hz');

                    // resetDisplayElements å®Ÿè¡Œ
                    this.audioDetector.resetDisplayElements();

                    // å°‘ã—å¾…ã£ã¦ã‹ã‚‰çµæœç¢ºèª
                    setTimeout(() => {
                        const volumeBar = document.getElementById('volume-bar-test');
                        const volumeText = document.getElementById('volume-text-test');
                        const frequencyDisplay = document.getElementById('frequency-display-test');

                        const isReset = (
                            volumeBar.style.width === '0%' &&
                            (volumeText.textContent === '0%' || volumeText.textContent === '0.0%') &&
                            (frequencyDisplay.textContent.includes('0.0 Hz') || frequencyDisplay.textContent.includes('261.6 Hz'))
                        );

                        if (isReset) {
                            this.logger.success('âœ… resetDisplayElements() UI ãƒªã‚»ãƒƒãƒˆæˆåŠŸ');
                            this.addResult('audio-detection-results', 'audioDetector.resetDisplayElements()', true, 'UIè¦ç´ ãŒæ­£å¸¸ã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã—ãŸ');
                        } else {
                            this.logger.warn('âš ï¸ resetDisplayElements() å®Œå…¨ãƒªã‚»ãƒƒãƒˆæœªç¢ºèª');
                            this.addResult('audio-detection-results', 'audioDetector.resetDisplayElements()', true, 'ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè¡Œå®Œäº†ï¼ˆéƒ¨åˆ†çš„ãƒªã‚»ãƒƒãƒˆï¼‰');
                        }
                    }, 100);

                    return true;
                } catch (error) {
                    this.logger.error(`âŒ resetDisplayElements() ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`);
                    this.addResult('audio-detection-results', 'audioDetector.resetDisplayElements()', false, error.message);
                }
                return false;
            }

            async testMicControllerGetter() {
                if (!this.audioDetector) {
                    this.logger.warn('âš ï¸ AudioDetectionComponent ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“');
                    return false;
                }

                try {
                    this.logger.info('ğŸ¤ microphoneController ã‚²ãƒƒã‚¿ãƒ¼ãƒ†ã‚¹ãƒˆé–‹å§‹');

                    const controller = this.audioDetector.microphoneController;

                    this.logger.success('âœ… microphoneController ã‚²ãƒƒã‚¿ãƒ¼å®Ÿè¡ŒæˆåŠŸ');
                    this.addResult('audio-detection-results', 'audioDetector.microphoneController', true, `ã‚²ãƒƒã‚¿ãƒ¼å®Ÿè¡Œå®Œäº†: ${controller ? 'MicrophoneControllerå–å¾—' : 'null(åˆæœŸåŒ–å‰)'}`);

                    return true;
                } catch (error) {
                    this.logger.error(`âŒ microphoneController ã‚²ãƒƒã‚¿ãƒ¼ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`);
                    this.addResult('audio-detection-results', 'audioDetector.microphoneController', false, error.message);
                }
                return false;
            }

            async testDeviceOptimize() {
                if (!this.audioDetector) {
                    this.logger.warn('âš ï¸ AudioDetectionComponent ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“');
                    return false;
                }

                try {
                    this.logger.info('ğŸ”§ detectAndOptimizeDevice() ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆé–‹å§‹');

                    if (typeof this.audioDetector.detectAndOptimizeDevice !== 'function') {
                        throw new Error('detectAndOptimizeDevice ãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨ã—ã¾ã›ã‚“');
                    }

                    const result = this.audioDetector.detectAndOptimizeDevice();

                    this.logger.success('âœ… detectAndOptimizeDevice() å®Ÿè¡ŒæˆåŠŸ');
                    this.addResult('audio-detection-results', 'audioDetector.detectAndOptimizeDevice()', true, `ãƒ‡ãƒã‚¤ã‚¹æœ€é©åŒ–å®Œäº†: ${JSON.stringify(result, null, 2)}`);

                    this.testResults.audioDetection = true;
                    return true;
                } catch (error) {
                    this.logger.error(`âŒ detectAndOptimizeDevice() ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`);
                    this.addResult('audio-detection-results', 'audioDetector.detectAndOptimizeDevice()', false, error.message);
                }
                return false;
            }

            // FAQ ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ†ã‚¹ãƒˆ
            simulateUsage() {
                this.logger.info('ğŸ­ éŸ³é‡ãƒ»å‘¨æ³¢æ•°ä½¿ç”¨çŠ¶æ³ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ');

                // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿è¨­å®š
                document.getElementById('volume-bar-test').style.width = '80%';
                document.getElementById('volume-text-test').textContent = '80%';
                document.getElementById('frequency-display-test').textContent = '523.3 Hz (C5)';

                this.logger.success('âœ… ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆå®Œäº†: éŸ³é‡80%, å‘¨æ³¢æ•°523.3Hz');

                // FAQ ãƒ†ã‚¹ãƒˆãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
                document.getElementById('test-faq-pattern1').disabled = false;
                document.getElementById('test-faq-pattern2').disabled = false;
                document.getElementById('test-faq-pattern3').disabled = false;
            }

            async testFAQPattern1() {
                try {
                    this.logger.info('ğŸ“– FAQæ–¹æ³•1ãƒ†ã‚¹ãƒˆ: stopDetection + resetDisplayElements');

                    if (this.audioDetector) {
                        // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ: stopDetection
                        this.logger.info('1ï¸âƒ£ audioDetector.stopDetection() å®Ÿè¡Œ');

                        // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ: resetDisplayElements
                        this.logger.info('2ï¸âƒ£ audioDetector.resetDisplayElements() å®Ÿè¡Œ');
                        this.audioDetector.resetDisplayElements();

                        this.logger.success('âœ… FAQæ–¹æ³•1 å®Ÿè¡Œå®Œäº†');
                        this.addResult('faq-pattern-results', 'FAQæ–¹æ³•1: stopDetection + resetDisplayElements', true, 'FAQæ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³1ã®å®Ÿè¡Œå®Œäº†');
                    } else {
                        this.logger.warn('âš ï¸ AudioDetectionComponent ãŒæœªä½œæˆã®ãŸã‚æ¨¡æ“¬å®Ÿè¡Œ');
                        this.addResult('faq-pattern-results', 'FAQæ–¹æ³•1: stopDetection + resetDisplayElements', true, 'æ¨¡æ“¬å®Ÿè¡Œå®Œäº†ï¼ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæœªä½œæˆï¼‰');
                    }

                    return true;
                } catch (error) {
                    this.logger.error(`âŒ FAQæ–¹æ³•1ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`);
                    this.addResult('faq-pattern-results', 'FAQæ–¹æ³•1: stopDetection + resetDisplayElements', false, error.message);
                }
                return false;
            }

            async testFAQPattern2() {
                try {
                    this.logger.info('ğŸ“– FAQæ–¹æ³•2ãƒ†ã‚¹ãƒˆ: MicrophoneController.reset()');

                    if (this.micController) {
                        this.logger.info('ğŸ”„ micController.reset() å®Ÿè¡Œï¼ˆçµ±åˆç®¡ç†ï¼‰');
                        await this.micController.reset();

                        this.logger.success('âœ… FAQæ–¹æ³•2 å®Ÿè¡Œå®Œäº†');
                        this.addResult('faq-pattern-results', 'FAQæ–¹æ³•2: MicrophoneController.reset()', true, 'FAQæ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³2ï¼ˆçµ±åˆç®¡ç†ï¼‰ã®å®Ÿè¡Œå®Œäº†');
                    } else {
                        this.logger.warn('âš ï¸ MicrophoneController ãŒæœªä½œæˆã®ãŸã‚æ¨¡æ“¬å®Ÿè¡Œ');
                        this.addResult('faq-pattern-results', 'FAQæ–¹æ³•2: MicrophoneController.reset()', true, 'æ¨¡æ“¬å®Ÿè¡Œå®Œäº†ï¼ˆã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼æœªä½œæˆï¼‰');
                    }

                    return true;
                } catch (error) {
                    this.logger.error(`âŒ FAQæ–¹æ³•2ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`);
                    this.addResult('faq-pattern-results', 'FAQæ–¹æ³•2: MicrophoneController.reset()', false, error.message);
                }
                return false;
            }

            async testFAQPattern3() {
                try {
                    this.logger.info('ğŸ“– FAQæ–¹æ³•3ãƒ†ã‚¹ãƒˆ: è©³ç´°åˆ¶å¾¡ãƒ‘ã‚¿ãƒ¼ãƒ³');

                    if (this.micController) {
                        this.logger.info('1ï¸âƒ£ micController.stopDetection() ãƒã‚§ãƒƒã‚¯');
                        if (typeof this.micController.stop === 'function') {
                            this.logger.info('2ï¸âƒ£ micController.resetAllComponents() ãƒã‚§ãƒƒã‚¯');
                            // resetAllComponents ã®å­˜åœ¨ç¢ºèªï¼ˆå†…éƒ¨ãƒ¡ã‚½ãƒƒãƒ‰ã®å¯èƒ½æ€§ï¼‰
                        }

                        this.logger.success('âœ… FAQæ–¹æ³•3 ãƒ¡ã‚½ãƒƒãƒ‰ç¢ºèªå®Œäº†');
                        this.addResult('faq-pattern-results', 'FAQæ–¹æ³•3: è©³ç´°åˆ¶å¾¡ãƒ‘ã‚¿ãƒ¼ãƒ³', true, 'FAQæ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³3ã®è©³ç´°åˆ¶å¾¡ãƒ¡ã‚½ãƒƒãƒ‰ç¢ºèªå®Œäº†');
                    } else {
                        this.logger.warn('âš ï¸ MicrophoneController ãŒæœªä½œæˆã®ãŸã‚æ¨¡æ“¬å®Ÿè¡Œ');
                        this.addResult('faq-pattern-results', 'FAQæ–¹æ³•3: è©³ç´°åˆ¶å¾¡ãƒ‘ã‚¿ãƒ¼ãƒ³', true, 'æ¨¡æ“¬å®Ÿè¡Œå®Œäº†ï¼ˆè©³ç´°åˆ¶å¾¡ç¢ºèªï¼‰');
                    }

                    this.testResults.faqPattern = true;
                    this.updateStatus('faq-pattern', 'success');
                    return true;
                } catch (error) {
                    this.logger.error(`âŒ FAQæ–¹æ³•3ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`);
                    this.addResult('faq-pattern-results', 'FAQæ–¹æ³•3: è©³ç´°åˆ¶å¾¡ãƒ‘ã‚¿ãƒ¼ãƒ³', false, error.message);
                    this.updateStatus('faq-pattern', 'error');
                }
                return false;
            }

            async runFullIntegration() {
                this.logger.info('ğŸ”— å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹');

                let successCount = 0;
                const totalTests = Object.keys(this.testResults).length;

                // å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®çµæœç¢ºèª
                for (const [section, result] of Object.entries(this.testResults)) {
                    if (result) {
                        successCount++;
                        this.logger.success(`âœ… ${section} ã‚»ã‚¯ã‚·ãƒ§ãƒ³: æ­£å¸¸`);
                    } else {
                        this.logger.warn(`âš ï¸ ${section} ã‚»ã‚¯ã‚·ãƒ§ãƒ³: æœªå®Œäº†ã¾ãŸã¯å¤±æ•—`);
                    }
                }

                const successRate = (successCount / totalTests) * 100;

                if (successRate === 100) {
                    this.logger.success('ğŸ‰ å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆ: å…¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³æˆåŠŸï¼');
                    this.updateStatus('integration', 'success');
                    this.updateOverallStatus('success', 'ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆæˆåŠŸ');
                } else if (successRate >= 75) {
                    this.logger.warn(`âš ï¸ å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆ: éƒ¨åˆ†æˆåŠŸ (${successRate.toFixed(0)}%)`);
                    this.updateStatus('integration', 'warn');
                    this.updateOverallStatus('warn', `éƒ¨åˆ†æˆåŠŸ (${successRate.toFixed(0)}%)`);
                } else {
                    this.logger.error(`âŒ å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆ: å¤šæ•°ã®å•é¡Œ (${successRate.toFixed(0)}%)`);
                    this.updateStatus('integration', 'error');
                    this.updateOverallStatus('error', `å¤šæ•°ã®å•é¡Œ (${successRate.toFixed(0)}%)`);
                }

                this.addResult('integration-results', 'å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆ', successRate >= 75, `æˆåŠŸç‡: ${successRate.toFixed(0)}% (${successCount}/${totalTests})`);

                this.testResults.integration = successRate >= 75;
            }

            resetAllTests() {
                this.logger.info('ğŸ”„ å…¨ãƒ†ã‚¹ãƒˆãƒªã‚»ãƒƒãƒˆå®Ÿè¡Œ');

                // ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¯ãƒªã‚¢
                this.micController = null;
                this.audioDetector = null;

                // ãƒ†ã‚¹ãƒˆçµæœãƒªã‚»ãƒƒãƒˆ
                this.testResults = {
                    micController: false,
                    audioDetection: false,
                    faqPattern: false,
                    integration: false
                };

                // UIçŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆ
                document.querySelectorAll('.status-indicator').forEach(indicator => {
                    indicator.className = 'status-indicator';
                });

                // ãƒœã‚¿ãƒ³çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆ
                document.querySelectorAll('.btn').forEach(btn => {
                    if (btn.id !== 'test-mic-controller' && btn.id !== 'test-audio-component' &&
                        btn.id !== 'simulate-usage' && btn.id !== 'run-full-integration' &&
                        btn.id !== 'reset-all-tests') {
                        btn.disabled = true;
                    }
                });

                // çµæœè¡¨ç¤ºã‚¯ãƒªã‚¢
                document.querySelectorAll('#mic-controller-results, #audio-detection-results, #faq-pattern-results, #integration-results').forEach(container => {
                    container.innerHTML = '';
                });

                // UIè¦ç´ ãƒªã‚»ãƒƒãƒˆ
                document.getElementById('volume-bar-test').style.width = '0%';
                document.getElementById('volume-text-test').textContent = '0%';
                document.getElementById('frequency-display-test').textContent = '440.0 Hz (A4)';

                this.logger.success('âœ… å…¨ãƒ†ã‚¹ãƒˆãƒªã‚»ãƒƒãƒˆå®Œäº†');
                this.updateOverallStatus('success', 'ãƒªã‚»ãƒƒãƒˆå®Œäº† - ãƒ†ã‚¹ãƒˆæº–å‚™å®Œäº†');
            }
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†æ™‚ã«ãƒ†ã‚¹ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸš€ README.md æ›´æ–°å†…å®¹æ¤œè¨¼ãƒ†ã‚¹ãƒˆé–‹å§‹');
            window.testManager = new TestManager();
        });
    </script>
</body>
</html>